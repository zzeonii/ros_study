# turtlesim
### Python
``` Python
#!/usr/bin/python
# -*- coding: utf-8 -*-

import rospy
from geometry_msgs.msg import Twist

rospy.init_node("turtle_patrol")
pub = rospy.Publisher("turtle1/cmd_vel", Twist, queue_size=10)

loop_rate = rospy.Rate(1)

msg = Twist()
msg.linear.x = 1.0

while not rospy.is_shutdown():
    pub.publish(msg)
    msg.linear.x *= -1
    loop_rate.sleep()
    
```

- 1. 터미널창에서 빌드(cm) 및 마스터 연결(roscore)
- 2. rosrun turtlesim turtlesim_node
- 3. rosrun yh_turtle turtle_patrol.py
- 4. rostopic echo /turtle1/cmd_vel (거북이 좌표 확인)

### turtlesim 앞뒤로 움직이게 바로 실행하기
- yh_turtle폴더에 launch 폴더 생성
- launch폴더에 turtle_patrol.launch 파일 생성
```
<launch>
    <!-- rosrun turtlesim turtlesim_node -->   
    <node pkg="turtlesim" type="turtlesim_node" name="turtleturtle" />
    <!-- rosrun yh_turtle turtle_patrol.py -->
    <node pkg="yh_turtle" type="turtle_patrol.py" name="patrolpatrol" />
</launch>
```
- 터미널창에 roslaunch yh_turtle turtle_patrol.launch

- 터미널창에서 rqt_graph 명령어를 통해 노드 이름 확인(launch파일 실행시에만 이름이 임시로 바뀌는 것!)

### turtlesim 방향키로 움직이기(거북이 전용 명령어)
- rosrun turtlesim turtle_teleop_key

sudo apt install ros-noetic-teleop-twist-keyboard
rostopic echo /cmd_vel
rosrun teleop_twist_keyboard teleop_twist_keyboard.py

#### turtle_keyboard.cpp
```CPP
#include "ros/ros.h"
#include "geometry_msgs/Twist.h"
// cmd_vel 토픽 subscribe ==> turtle1/cmd_vel 토픽 publish

ros::Publisher pub; // 전역변수

void msgCallback(const geometry_msgs::Twist::ConstPtr& msg)
{
    pub.publish(*msg);
}

int main(int argc, char** argv)
{
    ros::init(argc, argv, "turtle_keyboard");
    ros::NodeHandle nh;

    pub = nh.advertise<geometry_msgs::Twist>("turtle1/cmd_vel", 10);
    ros::Subscriber sub = nh.subscribe("cmd_vel", 10, msgCallback);

    ros::spin();

    return 0;
}
```
- 빌드 및 마스터 실행
- rosrun turtlesim turtlesim_node (터틀심 켜기)
- rosrun teleop_twist_keyboard teleop_twist_keyboard.py
- rosrun yh_turtle turtle_keyboard


#### turtle_keyboard.py
```Python
#!/usr/bin/python
# -*- coding: utf-8 -*-

import rospy
from geometry_msgs.msg import Twist

pub = rospy.Publisher("turtle1/cmd_vel", Twist, queue_size=20)

def msgCallback(msg):
    pub.publish(msg)

if __name__ == "__main__":
    rospy.init_node("turtle_keyboard")
    rospy.Subscriber("cmd_vel", Twist, msgCallback, queue_size=10)

    rospy.spin()
```
- CMakeList.txt 수정
- 빌드 및 마스터 실행
- rosrun turtlesim turtlesim_node
- rosrun teleop_twist_keyboard teleop_twist_keyboard.py
- rosrun yh_turtle turtle_keyboard.py

### turtlesim 바로 실행하는 launch 만들기
#### turtle_keyboard.launch
```
<launch>
    <!-- rosrun turtlesim turtlesim_node -->   
    <node pkg="turtlesim" type="turtlesim_node" name="turtlesim" />
    <!-- rosrun yh_turtle turtle_keyboard.py -->
    <node pkg="yh_turtle" type="turtle_keyboard.py" name="turtle_keyboard" />
    <!-- rosrun teleop_twist_keyboard teleop_twist_keyboard.py -->
    <node pkg="teleop_twist_keyboard" type="teleop_twist_keyboard.py" name="key" />    
</launch>
```
